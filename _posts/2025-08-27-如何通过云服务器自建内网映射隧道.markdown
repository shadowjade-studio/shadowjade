---
layout: post
title: 如何通过云服务器自建内网映射隧道
date: 2025-08-27 00:00:00 +0800
---

## 前言
这个内容其实我在一年前就做过一次，（[之前写的](https://blog.antares.xin/zaxiang/163/)），在搭建完成之后也给我朋友用过，也是在实践中发现让用户自己去安装客户端也好，还是给客户端添加为服务也好，对于用户来说其实都挺麻烦的，还是有一定的门槛，不是很方便。这几天翻看[有趣的开源社区 - HelloGitHub](https://hellogithub.com/)的时候，发现了一个蛮不错的frp客户端项目——[luckjiawei/frpc-desktop: frp跨平台桌面客户端，可视化配置，轻松实现内网穿透！ 支持所有frp版本](https://github.com/luckjiawei/frpc-desktop)。简单看了下，界面挺好看，操作也不复杂，OK，就你了。

## 服务端安装
### 准备工作
本次搭建需要用到两个开源项目
1. [luckjiawei/frpc-desktop: frp跨平台桌面客户端，可视化配置，轻松实现内网穿透！ 支持所有frp版本](https://github.com/luckjiawei/frpc-desktop)
	 ![frp跨平台桌面客户端](https://img.antares.xin/frp/1.webp)
2. [fatedier/frp: A fast reverse proxy to help you expose a local server behind a NAT or firewall to the internet.](https://github.com/fatedier/frp)
	![frp服务端](https://img.antares.xin/frp/2.webp)
需要下载的文件如下
3. frp服务端
	 ![frp服务端](https://img.antares.xin/frp/3.webp)
4. frp客户端
	![frp客户端](https://img.antares.xin/frp/4.webp)
### 安装frp服务端
1. 连接服务器并上传服务端文件，我使用的是Xftp 8和Xshell 8用于连接服务器
	![上传文件](https://img.antares.xin/frp/5.webp)
2. 切换到对应路径并解压文件  
	`cd /home/frp`  
	`tar -zxvf frp_0.64.0_linux_amd64.tar.gz`  
	解压完成后重命名文件夹方便后面输路径，其中frps.toml是服务端的配置文件，frps是服务端二进制程序
	![解压完成后的文件](https://img.antares.xin/frp/6.webp)
3. 修改配置文件
	`vim frps.toml`
	![修改配置文件](https://img.antares.xin/frp/7.webp)
	按i开始输入，ESC 再输入:wq退出编辑
```ini
bindPort = 7000 # 服务端端口
auth.method = "token" # 使用令牌进行身份验证 
auth.token = "Freetousevaliduntil2026-1-1@Antares.xin" # 令牌，客户端与服务端一致才能连接成功 推荐配置复杂一点
```
4. 启动服务端
	`./frps -c ./frps.toml`
	![启动服务端](https://img.antares.xin/frp/8.webp)
5. 将frp添加为服务并开启开机自启动
	1. 按下CTRL+C中断进程
	2. 创建 frps.service 文件
	3. 写入内容
	![写入内容](https://img.antares.xin/frp/18.webp)
	
```ini
[Unit]
# 服务名称，可自定义
Description = frp server
After = network.target syslog.target
Wants = network.target

[Service]
Type = simple
# 启动frps的命令，需修改为您的frps的安装路径
ExecStart = /path/to/frps -c /path/to/frps.toml

[Install]
WantedBy = multi-user.target
```
	4. 启动frp并设置开机自启动
```bash
# 启动frp
sudo systemctl start frps
# 停止frp
sudo systemctl stop frps
# 重启frp
sudo systemctl restart frps
# 查看frp状态
sudo systemctl status frps
设置 frps 开机自启动
sudo systemctl enable frps
```
	当你看到两个enabled和active (running)就说明在正常运行了
	![检查frp状态](https://img.antares.xin/frp/19.webp)
### 开启防火墙
我这边是阿里的云服务器，到阿里的控制台去开启防火墙，此处需要开启7000端口和你需要映射的目标端口，我这边把50000-60000端口全部开启了
![开启防火墙](https://img.antares.xin/frp/8-5.webp)
![开启防火墙](https://img.antares.xin/frp/8-9.webp)

## 安装frp客户端
客户端在windows下的安装还是很方便的，一直下一步即可。
安装完成后需要进行与服务器的连接。
1. 在设置里下载对应的frp版本，我的服务器用的是0.64.0，所以这里用的也是0.64.0，如果语言不是中文的话可以去最底下切换一下语言
	![下载对应的frp版本](https://img.antares.xin/frp/9.webp)
	![下载对应的frp版本](https://img.antares.xin/frp/10.webp)
2. 输入服务器地址，端口，验证方式选择令牌，然后把前面设的令牌输进去
	![设置](https://img.antares.xin/frp/11.webp)
3. 设置隧道
	选择你需要的代理类型，内网地址，两边的端口，我这边继续拿mc作为例子
	![设置隧道](https://img.antares.xin/frp/13.webp)
4. 设置完成后开启frp即可使用
	![设置隧道](https://img.antares.xin/frp/14.webp)
## 最终效果如下
![最终效果](https://img.antares.xin/frp/15.webp)
![最终效果](https://img.antares.xin/frp/16.webp)
、![最终效果](https://img.antares.xin/frp/17.webp)
## 参考的教程如下
1. [轻松掌握热门内网穿透工具：快速实现内网服务外部访问](https://jwinks.com/p/frp/#%E4%BB%80%E4%B9%88%E6%98%AF%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F)
2. [安装 | frp](https://gofrp.org/zh-cn/docs/setup/)
## 结语
这个服务器上搭建的frp可以供各位免费使用，服务器到明年一月到期  
地址：8.137.70.233  
端口：7000  
秘钥：Freetousevaliduntil2026-1-1@Antares.xin

